<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="./css/reset.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
	<style type="text/css">
		html,
		body {
			width: 100%;
			height: 100%;
			overflow: hidden;
		}

		#love {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: url('./img/bg.JPG');
			background-size: 100% 100%;
		}

		#timesong {
			border-width: 8px;
			border-radius: 20px;
		}

		/* #love {
			animation-duration: 8s;
			animation-delay: 2s;
			animation-iteration-count: infinite;
		} */
	</style>
</head>

<body>
	<div id="love">
		<audio id="sweetNothings" src="http://www.170mv.com/kw/other.web.ne01.sycdn.kuwo.cn/resource/n2/48/87/3095479698.mp3" autoplay>
			Your browser does not support the <code>audio</code> element.
		</audio>
		<p id="oath"></p>
		<img id="timesong" src="./img/0.JPG" width="35%">
	</div>
	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="./js/utils.js"></script>
	<script type="text/javascript">
		$(document).ready(function () {

			var $love = $('#love');
			var $oath = $('#oath')
			var $timesong = $('#timesong')

			// 图片边框样式
			var borderStyle = ['inset', 'outset', 'ridge', 'dotted', 'dashed', 'solid', 'double', 'groove'];
			var borderStyleLength = borderStyle.length

			// 判断横竖屏 start
			var supportOrientation = typeof window.orientation === 'number' &&
				typeof window.onorientationchange === 'object';
			var orientation;

			updateOrientation();
			function updateOrientation() {
				if (supportOrientation) {
					orientation = window.orientation;
					switch (orientation) {
						case 90:
						case -90:
							orientation = 'landscape';
							break;
						default:
							orientation = 'portrait';
							break;
					}
				} else {
					orientation = (window.innerWidth > window.innerHeight) ? 'landscape' : 'portrait';
				}
				var width = document.body.clientWidth
				var height = document.body.clientHeight
				if (orientation === 'landscape') {
					$love.width(width);
					$love.height(height);
					$love.css('top', 0);
					$love.css('left', 0);
					$love.css('transform', 'none');
					$love.css('transform-origin', '50% 50%');
				} else {
					$love.width(height);
					$love.height(width);
					$love.css('top', (height - width) / 2);
					$love.css('left', 0 - (height - width) / 2);
					$love.css('transform', 'rotate(90deg)');
					$love.css('transform-origin', '50% 50%');
				}
			};

			if (supportOrientation) {
				// safari
				window.addEventListener('orientationchange', function () {
					setTimeout(updateOrientation, 200)
				}, false);
			} else {
				// 监听 resize 事件
				window.addEventListener('resize', function () {
					setTimeout(updateOrientation, 200)
				}, false);
			}
			// 判断横竖屏 end

			// 动画状态: 0: 进入 1: 强调 2: 离开
			var animateStatus = 0
			function drow(n) {
				// 判断状态
				if (animateStatus >= 3) {
					animateStatus = 0
				}

				// class 切换
				if (animateStatus === 0) {
					// $love.removeClass().addClass('animated bounceInRight')
					// 移除 class, 添加进入动画的 class; 切换图片 src
				} else if (animateStatus === 1) {
					// $love.removeClass().addClass('animated flash')
					n = getRandomNum(4000, 6000)
					// 移除 class, 添加强调动画的 class
				} else if (animateStatus === 2) {
					// $love.removeClass().addClass('animated rotateOutUpRight')
					// 移除 class, 添加离开动画的 class
				}

				animateStatus++

				setTimeout(() => {
					drow(getRandomNum(1500, 3000))
				}, n);

			}
			drow(1500)


			function audioAutoPlay(id) {
				var audio = document.getElementById(id),
					play = function () {
						audio.play();
						document.removeEventListener("touchstart", play, false);
					};
				audio.play();
				document.addEventListener("WeixinJSBridgeReady", function () {
					play();
				}, false);
				document.addEventListener("touchstart", play, false);
			}
			audioAutoPlay('sweetNothings');
		})
	</script>
</body>

</html>
